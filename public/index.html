<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Gestoría Virtual - Solicitud</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="/styles.css" />
</head>
<body>
  <header class="top-bar">
    <div class="logo">Gestoría Virtual</div>
    <button id="btnAdmin" class="btn-secondary">Acceso operadores</button>
  </header>

  <main class="page">
    <section class="card">
      <h1>Solicitud de trámite</h1>
      <p class="subtitle">
        Completa tus datos y adjunta la información requerida. Al final se abrirá WhatsApp con el mensaje listo para enviar.
      </p>

      <form id="solicitudForm" class="form">
        <!-- DATOS PERSONALES -->
        <div class="field-group">
          <label for="nombre">Nombre(s) *</label>
          <input id="nombre" type="text" required />
        </div>

        <div class="field-group">
          <label for="apellidos">Apellidos *</label>
          <input id="apellidos" type="text" required />
        </div>

        <div class="field-group">
          <label for="curp">CURP *</label>
          <input id="curp" type="text" required />
        </div>

        <div class="field-group">
          <label for="telefono">Teléfono (WhatsApp) *</label>
          <input id="telefono" type="tel" required />
        </div>

        <div class="field-group">
          <label for="tipoLicencia">Tipo de licencia *</label>
          <select id="tipoLicencia" required>
            <option value="">Selecciona una opción</option>
            <option value="A">AUTOMOVILISTA - A</option>
            <option value="C">CHOFER - C</option>
            <option value="M">MOTOCICLISTA - M</option>
          </select>
        </div>

        <div class="field-group">
          <label for="vigencia">Vigencia *</label>
          <select id="vigencia" required>
            <option value="">Selecciona una opción</option>
            <option value="3">3 AÑOS $650</option>
            <option value="5">5 AÑOS $700</option>
          </select>
        </div>

        <div class="field-group">
  <label>
    ¿Aceptas que la licencia lleve domicilio del estado de Guerrero?
    <br />
    <small style="color:#6b7280">
      Como la licencia se tramita en Guerrero, se pide que salga con un domicilio de aquí.  
      En caso de no tener domicilio de Guerrero, la licencia saldrá con el domicilio del ayuntamiento donde se realiza el trámite.
    </small>
  </label>
  <label class="inline-checkbox">
    <input type="checkbox" id="domicilioGuerrero" />
    <span>Confirmo que acepto.</span>
  </label>
</div>

        <div class="field-group">
          <label for="tipoSangre">Tipo de sangre *</label>
          <select id="tipoSangre" required>
            <option value="">Selecciona una opción</option>
            <option value="O-">O-</option>
            <option value="O+">O+</option>
            <option value="A-">A-</option>
            <option value="A+">A+</option>
            <option value="B-">B-</option>
            <option value="B+">B+</option>
            <option value="AB-">AB-</option>
            <option value="AB+">AB+</option>
            <option value="DESCONOCE">Desconoce</option>
          </select>
        </div>

        <div class="field-group">
          <label for="emergenciaNombre">Nombre de contacto de emergencia *</label>
          <input id="emergenciaNombre" type="text" required />
        </div>

        <div class="field-group">
          <label for="emergenciaTelefono">Teléfono contacto de emergencia *</label>
          <input id="emergenciaTelefono" type="tel" required />
        </div>

        <div class="field-group">
          <label for="comentarios">Comentarios adicionales (opcional)</label>
          <textarea id="comentarios" rows="3"></textarea>
        </div>

        <hr class="divider" />

        <!-- DATOS DE ENVÍO -->
        <section class="section-block">
          <h2>Datos de envío</h2>

          <div class="field-group">
            <label for="envioNombreDestinatario">Nombre destinatario *</label>
            <input id="envioNombreDestinatario" type="text" required />
          </div>

          <div class="field-group">
            <label for="envioTelefonoDestinatario">Teléfono destinatario *</label>
            <input id="envioTelefonoDestinatario" type="tel" required />
          </div>

          <div class="field-group">
            <label for="envioCalle">Calle *</label>
            <input id="envioCalle" type="text" required />
          </div>

          <div class="field-group">
            <label for="envioNumero">Número *</label>
            <input id="envioNumero" type="text" required />
          </div>

          <div class="field-group">
            <label for="envioColonia">Colonia *</label>
            <input id="envioColonia" type="text" required />
          </div>

          <div class="field-group">
            <label for="envioCP">Código postal *</label>
            <input id="envioCP" type="text" required />
          </div>

          <div class="field-group">
            <label for="envioCiudadEstado">Ciudad y estado *</label>
            <input id="envioCiudadEstado" type="text" required />
          </div>
        </section>

        <hr class="divider" />

        <!-- FOTO PERSONA -->
        <section class="section-block">
          <h2>1. Foto de la persona</h2>
          <p class="help">Toma la foto con buena luz, de frente y sin lentes.</p>

          <div class="preview-actions">
            <button type="button" id="btnPersonaCamera" class="btn-secondary small">
              Tomar foto
            </button>
            <button type="button" id="btnPersonaFile" class="btn-secondary small">
              Subir archivo
            </button>
            <input type="file" id="fotoPersonaInput" accept="image/*" class="hidden-file" />
          </div>

          <div id="fotoPersonaPreview" class="image-preview empty">
            <span class="placeholder">Aún no hay foto</span>
          </div>

          <div id="fotoPersonaActions" class="preview-actions" style="display:none;">
            <button type="button" id="btnPersonaUsar" class="btn-primary small">
              Usar esta foto
            </button>
            <button type="button" id="btnPersonaCambiar" class="btn-secondary small">
              Cambiar foto
            </button>
          </div>
        </section>

        <hr class="divider" />

        <!-- FOTO IDENTIFICACIÓN -->
        <section class="section-block">
          <h2>2. Foto de identificación</h2>
          <p class="help">Toma foto clara de la identificación o súbela desde tus archivos.</p>

          <div class="preview-actions">
            <button type="button" id="btnIdCamera" class="btn-secondary small">
              Tomar foto
            </button>
            <button type="button" id="btnIdFile" class="btn-secondary small">
              Subir archivo
            </button>
            <input type="file" id="fotoIdInput" accept="image/*" class="hidden-file" />
          </div>

          <div id="fotoIdPreview" class="image-preview empty">
            <span class="placeholder">Aún no hay foto</span>
          </div>

          <div id="fotoIdActions" class="preview-actions" style="display:none;">
            <button type="button" id="btnIdUsar" class="btn-primary small">Usar</button>
            <button type="button" id="btnIdCambiar" class="btn-secondary small">Cambiar</button>
          </div>
        </section>

        <hr class="divider" />

        <!-- FIRMA -->
        <section class="section-block">
          <h2>3. Firma</h2>

          <div class="tabs">
            <button type="button" id="tabFirmaSubir" class="tab-button active">
              Subir imagen
            </button>
            <button type="button" id="tabFirmaDibujar" class="tab-button">
              Dibujar firma
            </button>
          </div>

          <!-- Subir firma -->
          <div id="firmaSubirPanel">
            <input type="file" id="fotoFirmaInput" accept="image/*" />
            <div id="firmaPreview" class="image-preview empty">
              <span class="placeholder">Aún no hay firma</span>
            </div>
          </div>

          <!-- Dibujar firma -->
          <div id="firmaDibujarPanel" style="display:none;">
            <div class="signature-wrapper">
              <canvas id="signaturePad"></canvas>
            </div>

            <div class="preview-actions">
              <button type="button" id="btnLimpiarFirma" class="btn-secondary small">
                Limpiar
              </button>
              <button type="button" id="btnConfirmarFirmaCanvas" class="btn-primary small">
                Confirmar firma
              </button>
            </div>
          </div>

          <div id="firmaActions" class="preview-actions" style="display:none;">
            <button type="button" id="btnFirmaCambiar" class="btn-secondary small">
              Cambiar firma
            </button>
          </div>
        </section>

        <!-- HIDDEN FIELDS -->
        <input type="hidden" id="personaPhotoUrl" />
        <input type="hidden" id="idPhotoUrl" />
        <input type="hidden" id="firmaUrl" />

        <div class="form-footer">
          <button type="submit" class="btn-primary full">Enviar por WhatsApp</button>
          <p class="small-note">Se abrirá WhatsApp con el mensaje listo.</p>
        </div>
      </form>
    </section>
  </main>

  <!-- LOADER -->
  <div id="globalLoader" class="global-loader" style="display:none;">
    <div class="loader"></div>
    <span>Procesando imagen, por favor espera...</span>
  </div>

  <!-- MODAL CÁMARA -->
  <div id="cameraModal" class="camera-modal" style="display:none;">
    <div class="camera-box">
      <video id="cameraVideo" autoplay playsinline></video>
      <img id="cameraSilhouette" class="silhouette-overlay" src="/silueta.png" />
      <div class="camera-controls">
        <button id="takePhotoBtn" class="btn-primary full">Tomar foto</button>
        <button id="closeCameraBtn" class="btn-secondary full">Cancelar</button>
      </div>
    </div>
  </div>

  <script src="/app.js"></script>
</body>
</html>
